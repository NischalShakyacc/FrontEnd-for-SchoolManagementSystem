{"ast":null,"code":"import { GRID_CHECKBOX_SELECTION_COL_DEF } from '../../../../colDef';\nimport { buildWarning } from '../../../../utils/warning';\nfunction sanitizeCellValue(value, delimiterCharacter) {\n  if (typeof value === 'string') {\n    var formattedValue = value.replace(/\"/g, '\"\"');\n\n    // Make sure value containing delimiter or line break won't be split into multiple rows\n    if ([delimiterCharacter, '\\n', '\\r'].some(function (delimiter) {\n      return formattedValue.includes(delimiter);\n    })) {\n      return \"\\\"\".concat(formattedValue, \"\\\"\");\n    }\n    return formattedValue;\n  }\n  return value;\n}\nexport var serializeCellValue = function serializeCellValue(cellParams, options) {\n  var delimiterCharacter = options.delimiterCharacter,\n    ignoreValueFormatter = options.ignoreValueFormatter;\n  var value;\n  if (ignoreValueFormatter) {\n    var _cellParams$value2;\n    var columnType = cellParams.colDef.type;\n    if (columnType === 'number') {\n      value = String(cellParams.value);\n    } else if (columnType === 'date' || columnType === 'dateTime') {\n      var _cellParams$value;\n      value = (_cellParams$value = cellParams.value) == null ? void 0 : _cellParams$value.toISOString();\n    } else if (typeof ((_cellParams$value2 = cellParams.value) == null ? void 0 : _cellParams$value2.toString) === 'function') {\n      value = cellParams.value.toString();\n    } else {\n      value = cellParams.value;\n    }\n  } else {\n    value = cellParams.formattedValue;\n  }\n  return sanitizeCellValue(value, delimiterCharacter);\n};\nvar objectFormattedValueWarning = buildWarning(['MUI: When the value of a field is an object or a `renderCell` is provided, the CSV export might not display the value correctly.', 'You can provide a `valueFormatter` with a string representation to be used.']);\nvar serializeRow = function serializeRow(_ref) {\n  var id = _ref.id,\n    columns = _ref.columns,\n    getCellParams = _ref.getCellParams,\n    delimiterCharacter = _ref.delimiterCharacter,\n    ignoreValueFormatter = _ref.ignoreValueFormatter;\n  return columns.map(function (column) {\n    var cellParams = getCellParams(id, column.field);\n    if (process.env.NODE_ENV !== 'production') {\n      if (String(cellParams.formattedValue) === '[object Object]') {\n        objectFormattedValueWarning();\n      }\n    }\n    return serializeCellValue(cellParams, {\n      delimiterCharacter: delimiterCharacter,\n      ignoreValueFormatter: ignoreValueFormatter\n    });\n  });\n};\nexport function buildCSV(options) {\n  var columns = options.columns,\n    rowIds = options.rowIds,\n    getCellParams = options.getCellParams,\n    delimiterCharacter = options.delimiterCharacter,\n    includeHeaders = options.includeHeaders,\n    ignoreValueFormatter = options.ignoreValueFormatter;\n  var CSVBody = rowIds.reduce(function (acc, id) {\n    return \"\".concat(acc).concat(serializeRow({\n      id: id,\n      columns: columns,\n      getCellParams: getCellParams,\n      delimiterCharacter: delimiterCharacter,\n      ignoreValueFormatter: ignoreValueFormatter\n    }).join(delimiterCharacter), \"\\r\\n\");\n  }, '').trim();\n  if (!includeHeaders) {\n    return CSVBody;\n  }\n  var CSVHead = \"\".concat(columns.filter(function (column) {\n    return column.field !== GRID_CHECKBOX_SELECTION_COL_DEF.field;\n  }).map(function (column) {\n    return sanitizeCellValue(column.headerName || column.field, delimiterCharacter);\n  }).join(delimiterCharacter), \"\\r\\n\");\n  return \"\".concat(CSVHead).concat(CSVBody).trim();\n}","map":null,"metadata":{},"sourceType":"module"}